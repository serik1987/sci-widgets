# Дерево элементов

Для создания дерева надо вставить следующий HTML-код

```
<sci-tree label="Root element">
    <sci-tree-node label="Node 1"></sci-tree-node>
    <sci-tree-node label="Node 2">
        <sci-tree-node label="Node 3"></sci-tree-node>
        <sci-tree-node label="Node 4"></sci-tree-node>
    </sci-tree-node>
    <sci-tree-node label="Node 5"></sci-tree-node>
</sci-tree>
```

Поскольку Элементы sci-tree и sci-tree-node очень сильно взаимосвязаны друг с другом, то в этом файле 
приведена справка по обеим элементам.

Строительство дерево начинается со строительства главного (корневого узла). Метка корневого узла совпадает
со значением атрибута label элемента sci-tree, а значение корневого узла всегда равно root. К корневому узлу
прикрепляются элементы sci-tree-node, которые являются дочерними по отношению к элементу sci-tree. Они становятся
дочерними элементами корневого узла. Далее иерархия переносится без изменений.

Значением виджета называется значение атрибута value того узла дерева (элемента sci-tree-node), которое выбрал
пользователь, нажав на этот элемент мышкой. В случае наличия множественного выбора за значение атрибута sci-tree
принимается объект класса Set: множество значений атрибута value всех элементов, выбранных пользователем.

Промежуточным звеном называется такой элемент sci-tree-node, который имеет хотя бы один дочерний элемент sci-tree-node.
Если элемент sci-tree-node не имеет ни одного дочернего элемента sci--tree-node, то такое звено называется конечным.

## Атрибуты

### Атрибуты sci-tree

#### branch-non-selectable

Если этот атрибут проставлен, то пользователь может выбрать только конечные звенья, а также те звенья, у которых
проставлен атрибут selectable.

Если проставлен атрибут non-selectable, либо свойство selectable принимает значение true, то пользователь не сможет
выбрать ни одного звена.

#### compacted

Если этот атрибут проставлен, то все промежуточные звенья будут свёренуты. Не работает в случае, если атрибут
expandable не проставлен.

#### expandable

Если этот атрибут проставлен, то дерево является раскрывающимся. Дерево является раскрывающимся, если его корневой
узел является раскрывающимся (см. свойство expandable для узла).

#### label

Задаёт метку корневого элемента

#### multiple

Если этот атрибут присутствует, то разрешён множественный выбор, а значением свойства value является объект класса
Set. Если этот атрибут отсутствует, то множественный выбор запрещёнЮ, а значением свойства value является строка - 
значение атрибута value узла, выбранного пользователем.

Данный атрибут не имеет эффекта, если стоит атрибут non-selectable

#### non-deletable

Если данный атрибут проставлен, то корневой узел дерева неудаляем. Если данный атрибут не стоит, то корневой узел
дерева удаляем.

#### non-editable

Если этот атрибут проставлен, то корневой узел дерева не является редактируемым. Это значит, что по-умолчанию
пользователь теперь не сможет изменять узлы, нажав на иконку с карандашом.

Такое поведение ну будет распространяться на звенья, у которых проставлены атрибуты editable и non-editable, а также
на звенья-потомки. См. подробно описание этих атрибутов.

#### non-selectable

Если этот атрибут проставлен, то пользователь не может выбрать то или иное звено дерева, просто нажав на него.
При этом присвоение какого-либо значения свойству selectable не работает.

Значение данного атрибута игнорируется, если выставлен атрибут selectable.

#### no-lines

Если этот атрибут проставлен, то у всех звеньев дерева, кроме тех, у которых проставлены атрибуты lines или no-lines,
не будут рисоваться линии.

#### selectable

Если этот атрибут проставлен, то пользователь может выбрать то или иное звено дерева, просто напросто нажав на него.
При этом значение атрибута non-selectable не учитывается, а присвоение значения свойству selectable невозможно.

#### value [только чтение]

Задаёт значение виджета на момент его создания. При изменении значения атрибута multiple текущее значение
виджета меняется на значение, прописанное в этом атрибуте.

В случае включения множественного выбора таким способом можно задавать только самый первый выбранный элемент.
Все остальные элементы должны задаваться вручную, средствами Javascript.

### Атрибуты sci-tree-node

#### deletable

Если этот атрибут проставлен, то данное звено становится удаляемым вне зависимости от удаляемости родительского звена

#### disabled

Работа этого атрибута отличается от работы атрибута disabled у SciWidget. Если этот атрибут проставлен, то элемент
считается неактивен. Однако, если этот атрибут убран, то элемент становится активным не всегда, а только в одном из
двух случаев:
* если у этого элемента проставлен атрибут enabled
* если родительский узел является активным. При этом активность или неактивность корневого узла определяется активностью
или неактивностью самого дерева.

#### editable

Если данный атрибут проставлен, то указанное звено является редактируемым. Это означает, что пользователь может
сменить название этого звена, нажав на кнопку с карандашом справа от него.

Данный атрибут наследуется. Это означает, что если родительский элемент является редактируемым, то и его дочерний
элемент также редактируем, при условии, что у этого дочернего элемента не проставлен атрибут non-editable.

#### enabled

Если данный атрибут проставлен, то элемент считается активным. Однако, если атрибут убран, то элемент будет неактивным
только в одном из двух случаев:
* если у него проставлен атрибут disabled;
* если родительский узел также неактивен.

### lines

Если этот атрибут выставлен, то под данным звеном рисуются линии, соединяющие его со следующим звеном. Если этот
атрибут убран, то наличие или отсутствие соединительных линий определяется принципом наследования.

Принцип наследования: если под данным звеном рисуются линии, то и под дочерними звеньями, у которых не проставлены
атрибуты lines или no-lines, также будут рисоваться линии.

#### expandable

Если это свойство проставлено, то данный элемент является раскрывающимся. Это означает, что слева от элемента
отображается значок "+", нажав на который, можно свернуть все дочерние элементы. Если пользователь снова нажмёт на
значок "+", то все дочерние элементы снова откроются.

Данный атрибут наследуется. Это означает, что если данный узел является раскрывающимся, то и все дочерние узлы
являются раскрывающимися, кроме тех, для которых проставлены атрибуты expandable и non-expandable, а также их
дочерних узлов.

Более подробное определение того, какие узлы являются раскрывающимися, а какие - нет, см. в свойстве expandable.

#### non-deletable

Если данный атрибут проставлен, то звено становится неудаляемым вне зависимости от удаляемости родительского звена.

#### non-editable

Если этот атрибут проставлен, то данный элемент не является редактируемым. Это означает, что пользователь не сможет
изменить название этого элемента.

Нередактируемость звеньев наследуется: родительский элемент не является редактируемым, то и дочерний элемент также
редактируемым не является, при условии, что у него не проставлен атрибут editable.

#### non-expandable

Если этот атрибут проставлен, то данный элемент не является раскрывающимся, даже, если его предок является
раскрывающимся. Подобное свойство распространяется на дочерние узлы, кроме тех, у которых проставлены атрибуты
expandable или non-expandable, а также их дочерние узлы.

Более подробное определение того, какие узлы являются раскрывающимися, а какие - нет, см. в свойстве expandable.

#### non-selectable

Если этот атрибут выставлен, то пользователь (но не само приложение!) не сможет выделить данный элемент, либо снять
с него выделение.

Значение данного атрибута игнорируется, если выставлен атрибут selectable.

Если данный атрибут выбран, то присваивание значения свойству selectable невозможно.

#### no-lines

Если этот атрибут проставлен, то под узлом не рисуется никаких линий. Если атрибут убран, то поведение линий
определяется принципом наследования.

Принцип наследования: если под данным звеном не рисуется никакиз ниний, то и у всех дочерних звеньев, у которых не
выставлены атрибуты lines и no-lines, также не рисуется никаких линий.

#### selectable

Если этот атрибут выставлен, то пользователь (но не само приложение!) может выделить данный элемент, либо снять с него
выделение.

Если этот атрибут выставлен, то атрибут non-selectable игнорируется. Кроме того, присваивание значения свойству
selectable также игнорируется. Если выставлен атрибут selectable, то на данный узел не распространяется влияние
атрибутов selectable, non-selectable, branch-non-selectable, tree-non-selectable родительского элемента sci-tree.

## Свойства

### Свойства SciTree

#### branchNonSelectable

Если значение данного свойства равно true, то пользователь сможет выбрать только конечные звенья. Если же значение
данного свойства равно false, то пользователь может выбрать как промежуточные, так и конечные звенья.

Если проставлен атрибут non-selectable, либо свойство selectable принимает значение true, то пользователь не сможет
выбрать ни одного звена.

#### customDeleteBox

Если данное свойство принимает значение, равное null, то удаление звена происводится без каких-либо предупреждений:
как только пользователь нажимает на крестик, элемент сразу же удаляется.

Однако значением данного свйоства может быть и функция вида:
```
tree.customDeleteBox = function(value, label) { ..... }
```
В этой ситуации, когда пользователь нажимает на крестик, эта функция запускается. В качестве аргументов в неё
подставляются значение и метка удаляемого узла. Данная функция должна вернуть промис. Удаление звена происходит только
после успешного разрешения этого промиса. В случае, если промис отвергается, то никакого удаления узла не происходит,
равно как и не выбрасывается никакое исключение.

#### customEditBox

По-умолчанию данное свойство принимает значение, равное null. Это означает, что для редактирования узла пользователю
предоставляется стандартная форма, встроенная в sci-tree, которую пользователь и должен заполнить для того, чтобы
изменить узел. Тем не менее, если Вы хотите встроить свою собственную форму, то Вам необходимо присвоить этому
свойству некоторую функцию, которая и вызывает пользовательский диалог.

Указанная функция принимает два аргумента: value и label, которые соответствуют значениям атрибутов value и label
редактируемого узла. Функция должна возвращать промис, который и отвечает за открытие формы.

Успешное разрешение промиса означает, что пользователь внёс изменения в название узла и хочет, чтобы эти изменения
были применены. Промис должен разрешаться новым значением атрибута label, которое ввёл пользователь.

Промис отвергается тогда и только тогда, когда пользователь отменил процедуру изменения узла. В этом случае атрибуту
label будет возвращено старое значение.

#### defaultValue [только чтение]

Значение value на момент создания виджета. При изменении значения свойства multiple текущее значение виджета
меняется на значение, прописанное в этом атрибуте.

#### expandable

Если значение этого свойства - true, это данное дерево является раскрывающимся. Если значение этого свойства - false,
то данное дерево не является раскрыывающимся.

Более подробное определение того, какие узлы являются раскрывающимися, а какие - нет, см. в свойстве expandable.ы

#### label

Управляет меткой корневого элемента дерева

#### length [только чтение]

Возвращает общее количество узлов в дереве, не считая корневого узла.

#### multiple

Если это свойство принимает значение true, то это означает, что выбор нескольких элементов списка пользователем
разрешён. В этом случае значением свойства value является объект класса Set, который представляет собой множество
значений атрибутов value всех узлов, которые отметил пользователь.

Если это свойство принимакет значение false, то это означает, что множественный выбор узлов пользователем невозможен.
В этом случае значением свойства value является строка - значение атрибута value выбранного пользователем узла дерева.

Это свойство не действует в случае, если свойство nonSelectable принимает значение, равное true.

#### nonDeletable

Если данное свойство принимает значение true, то корневое звено неудаляемо. Если данное свойство принимает значение
false, то корневое звено удаляемо.

#### nonEditable

Если данное свойство принимает значение true, то корневое звено является нередактируемым. Если данное свойство
принимает значение false, то корневое звено редактируемо

#### noLines

Если данное свойство принимает значение true, то у данного дерева не рисуются линии (кроме звеньев, у которых
проставлены атрибуты lines или no-lines, а также их потомков). Если данное свойство принимает значение false, то у
данного дерева рисуются линии (кроме звеньев, у которых проставлены атрибуты lines и no-lines, а также их потомков)

#### root [только чтение]

Возвращает HTML-элемент, соответствующий корневому элементу дерева.
Корневой элемент дерева создаётся автоматически при создании самого дерева. Это - не тот элемент, который вы
прописали внутри элемента sci-tree: все прописанные Вами элементы копируются внутрь корневого элемента.

#### selectable [Только чтение]

Если значение этого свойства true, то пользователь может выбрать нужное звено дерева, щёлкнув мышкой по его названию.
Если значение этого свойства - false, то пользователь так сделать не может.

Значение данного свойства не распространяется на узлы, у которых проставлены атрибуты selectable или
non-selectable.

Значение данного свойства систематически меняется элементом sci-tree, поэтому, если Вы присвоите данному свойству
какое-либо значение, то стабильная работа виджета не гарантирована.

#### value

Содержит значение виджета.

Если множественный выбор запрещён (свойство multiple принимает значение, равное false), то значением виджета является
значение атрибута value узла, который выбрал пользователь, либо null, если пользователь не выбрал какой-либо узел.
При этом самому виджету можно присвоить либо строковое значение, либо null. Если значение свойства value не
соответствует ни одному из узлов дерева, то оно автоматически приравнивается к null.

Если множественный выбор разрешён (свойство multiple принимает значение, равное true), то значением виджета является
объект класса Set - множество значений атрибутов value всех узлов, которые выбрал пользователь. Все элементы этого
множества, не соответствующие ни одному из узлов, игнорируются. При этом самому виджету можно присвоить одно из
следующих значений:
* null - очищает множество всех элементов, выбранных пользователем
* строковое значение - добавляет соответствующую строку в множество элементов, если она не была добавлена, убирает её,
если она была добавлена
* объект класса Set - значению этого свойства присваивается копия этого объекта
* массив - массив преобразуется в объект класса Set, после чего этот объект присваивается данному свойству.

Если свойство nonSelectable принимает значение, равное true, то значение данного свойства всегда равно null.
В этом случае присваивание этому свойству того или иного значения не будет иметь эффекта.

### Свойства SciTreeNode

#### childTreeNodes [только чтение]

Возвращает список дочерних звеньев дерева.

#### compacted

Данное свойство работает только тогда, когда значение свойства expandable равно true.

Если значение этого свойства равно true, то узел находится в свёрнутом состоянии. Если значение этого свойства равно
false, то узел находится в развёрнутом состоянии.

#### deletable [Только чтение]

Если данное свойство принимает значение true, то звено является удаляемым. Это означает, что пользователь может
удалить это звено вместе с дочерними звеньями, нажав на крестик справа от его названия. Если данное свойство принимает
значение false, то звено является неудаляемым, и пользователь так сделать не может.

Удаляемость или неудаляемость звена рассчитывается автоматически на основе следующих правил:
* если проставлен атрибут deletable, то звено удаляемо;
* если проставлен атрибут non-deletable, то звено неудаляемо;
* если проставлены оба атрибута, то звено удаляемо;
* если не проставлен ни один из атрибутов, то звено удаляемо в том случае, если родительское звено удаляемо и
неудаляемо, если родительское звено неудаляемо;
* удаляемость корневого звена определяется атрибутом non-deletable корневого элемента.

#### deleteButton [только чтение]

Возвращает HTML-элемент кнопки удаления данной звена от дерева. Звено удаляется вместе со всеми дочерники звеньями!
Пользователь не может также удалить корневое звено.

#### disabled

Если элемент неактивен, то данное свойство принимает значение, равное true. Если узел активен, то данное свойство
принимает значение, равное false.

Присваивание данному свойству значения true или false ведёт к выставлению нужных атрибутов, после чего наследование
теряется.

#### editable [только чтение]

Если данное свойство принимает значение true, то данный элемент является редактируемым. Если свойство принимает
значение false, то данный элемент не является редактируемым.

Пользователь может изменить название редактируемого звена, нажав на иконку с карандашом. Для нередактируемых звеньев
такая возможность отсутствует.

Свойство доступно только для чтения. Если вы присвоите данному свойству какое-либо значение, то элемент sci-tree в
скором времени вернёт этому свойству старое значение. Редактируемость звена расчитывается на основе следующих правил:
* звено, у которого проставлен атрибут editable, редактируемо;
* звено, у которого проставлен атрибут non-editable, нередактируемо;
* если оба атрибута проставлены, звено считается редактируемым;
* если оба атрибута отсутствуют, то редактируемость звена в точности соответсвует редактируемости родительского звена;
* по-умолчанию корневое звено редактируемо. Однако если у дерева проставлен атрибут non-editable, то корневое звено
нередактируемо.

#### editButton [только чтение]

Возвращает HTML-элемент кнопки изменения звана от дерева

#### editing [только чтение]

Если значение данного свойства равно true, то данный узел находится в состоянии редактирования: отображается поле
для ввода и кнопки внесения изменений в виджет а также отмены внесенных изменений. Если значение данного свойства
равно false, то данный узел находится в состоянии просмотра: подобные поля не отображаются.

Пользователь может перевести в состояние редактирования, нажав на кнопку с карандашом. Для вывода из состояния
редактирования пользователю надо либо нажать на кнопку с галочкой, либо на кнопку с крестиком.

#### enabled

Если данное свойство принимает значение, равное true, то узел дерева активен. Если оно принимает значение, равное
false, то узел дерева неактивен.

Присваивание этому атрибуту значения true, либо false ведёт с изменению атрибутов enabled и disabled, что. в свою
очередь, выключает наследование данного свойства.

#### expandable [только чтение]

Если данное свойство принимает значение true, то данный узел является раскрывающимся. Если же свойство принимает
значение false, то данный узел раскрывающимся не является.

Если узел (кроме корневого) является раскрывающимся, то слева от него отображается кнопка с плюсом. Как только
пользователь нажимает на эту кнопку, все дочерние элементы тут же открываются, а кнопка превращается в кнопку с минусом.
Как только пользователь нажимает на кнопку с минусом, то все дочерние элементы также пропадают.

Если атрибут expandable выставлен, то узел является раскрывающимся. если узел non-expandable выставлен, то
элемент не является раскрывающимся. При одновременно выставленных атрибутах expandable и non-expandable элемент
является раскрывающимся. Если же ни один из атрибутов не выставлен, то узел является раскрывающимся, если его
родительский элемент является раскрывающимся и не является раскрывающимся, если его родительский элемент не является
раскрывающимся.

#### length [только чтение]

Возвращает количество дочерних узлов относительно данного конкретного узла.

#### lines

Если значение данного свойства равно true, то под данным звеном рисуются линии. Если значение данного свойства равно
false, то под данным звеном не рисуются линии.

Свойство рассчитывается автоматически на основе следующих правил:
* если у звена проставлен атрибут lines, то свойство принимает значение true, линии рисуются;
* если у звена проставлен атрибут no-lines, то свойство принимает значение false, линии не рисуются;
* если оба атрибута отсутствуют, то свойство принимает значение true, если свойство lines родительского звена принимает
значение true и принимает значение false, если  свойство lines родительского звена принимает значение false;
* значение свойства lines корневого звена определяется наличием атрибута no-lines элемента sci-tree.

Присвоение значений true или false свойству lines ведёт к изменению атрибутов lines и no-lines.

#### parentTree [только чтение]

Для корневого элемента данное свойство принимает значение того элемента sci-tree, корневым элементом которого
оно является. Для всех остальных элементов данное свойство равно родительскому корневому узлу.

#### root [только чтение]

Возвращает true, если данный элемент является корневым элементом и false в противном случае.

#### selectable [в случае, если атрибуты selectable или non-selectable выславлены - только чтение]

Если данное свойство принимает значение true, то пользователь может выбрать данный элемент, произведя по нему щелчок.
Если данное свойство принимает значение false, то пользователь не сможет таким способом выбрать элемент
(тем не менее, его можно выбрать через свойство value элемента sci-tree).

#### selected

Если данное свойство принимает значение, равное true, то элемент считается выбранным. Если же оно принимает значение
false, то элемент считается не выбранным.

Метки выбранных элементов всегда окрашиваются в синий цвет, однако это не влияет на значение свойства value самого
дерева

#### value

Значение атрибута value элемента SciTreeNode. Когда пользователь выбирает данный элемент, то это значение этого свойства
автоматически становится значением свойства объекта SciTree.

Корневой элемент дерева всегда имеет значение 'root'.

## Методы

### Методы SciTree

#### $(value)

Ищет узел, чьё значение (то есть, значение атрибута value) равно value. Если таких
элементов несколько, выбирается самый первый элемент. Если такие элементы отсутствуют, то возвращается null.

#### addValue(value)

Если множественный выбор разрешён, то добавляет value в множество значений, выбранных пользователем. Если множественный
выбор запрещён, то присвоивает свойству value указанное значение.

#### iterate(deep = false)

Возвращает итерируемый объект, который позволяет осуществлять итерацию по всем узлам, дочерним по отношению к корневому
узлу, в в случае, если аргумент deep принимает значение true - то и по всем узлам, входящим в состав дерева, кроме
корневого узла.

#### removeValue(value)

Если множественный выбор разрешён, то добавляет value в множество значений, выбранных пользователем. Если множественный
выбор запрещён, то значению value присваивается null в том случае, если оно принимает значение, указанное в аргументе.

### Методы SciTreeNode

#### $(value)

Ищет среди всех потомков данного узла тот, что чьё значение (то есть, значение атрибута value) равно value. Если таких
элементов несколько, выбирается самый первый элемент. Если такие элементы отсутствуют, то возвращается null.

#### compact()

Сворачивает узел. Работает только тогда, когда свойство expandable принимает значение, равное true.

#### expand()

Разворачивает узел. Работает только тогда, когда свойство expandable принимает значение, равное true.

#### iterate(deep = false)

Возвращает итерируемый объект, который позволяет осуществлять итерацию по всем дочерним объектам, а в случае, если
параметр deep принимает значение, равное true, то и по всем объектам потомкам.

#### select()

Делает элемент выбранным.

Метки выбранных элементов всегда окрашиваются в синий цвет, однако это не влияет на значение свойства value самого
дерева

#### unselect()

После выполнения данного метода элемент перестаёт быть выбранным.

Метки выбранных элементов всегда окрашиваются в синий цвет, однако это не влияет на значение свойства value самого
дерева

## События

### События SciTree

Все события генерируемые деревом и не генерируемые элементом HTMLElement - кастомные (CustomEvent). У кастомных событий
свойство detail принимает значение свойства value узла-источника события.

#### sci-tree-compact

Возникает, когда пользователь сворачивает промежуточное звено.

#### sci-tree-delete

Возникает, когда пользователь удаляет элемент дерева, нажимая на кнопку с крестиком.

#### sci-tree-edit-cancel

Генерируется тогда, когда пользователь отменит редактирование элемента, нажав на кнопку с галочкой.

#### sci-tree-edit-finish

Генерируется тогда, когда пользователь завершает редактирование элемента, нажимая на кнопку с галочкой.

#### sci-tree-edit-start

Генерируется тогда, когда пользователь нажимает на кнопку с карандашом, инициализируя тем самым редактирование элемента.

#### sci-tree-expand

Возникает, когда пользователь раскрывает промежуточное звено.

#### sci-tree-select

Возникает при выборе пользователем того или иного узла. Не генерируется, если узел или дерево неактивны.
